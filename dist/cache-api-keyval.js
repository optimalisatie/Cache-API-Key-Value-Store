!function(){function g(a){a&&(b.CacheApiDB=a);for(a=p.shift();a;)a()}var b="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,p=[];b.onCacheApiDB=function(a){b.CacheApiDB?a():p.push(a)};b.CacheApiDBFallback||(b.CacheApiDBFallback=function(){var a=this;a.no=1;["get","set","del","prune"].forEach(function(b){a[b]=function(){return Promise.reject("No Cache API")}})});"caches"in b&&caches instanceof CacheStorage?(b.CacheApiDB=function(){function a(d,
c){return caches.open(d).then(c)}function b(d,c,a){var b=a.headers.get("x-e");a=a.headers.get("x-d");if(b&&a&&(b=parseInt(b),parseInt(a)+b<Math.round(Date.now()/1E3)))return g(d,c,1),!0}function g(d,c,b){return a(d,function(a){return k(c)&&l(),c=b?c:new Request((c||"").toString()),a["delete"](c)})}function e(a,c){if(!(this instanceof e))return new e(a,c);this.a=a;"object"===typeof c&&c.namespace&&(this.b=c.namespace)}function m(a,c){return(a?a+":":"")+c}function k(a){return"undefined"===typeof a}
function l(){throw Error("input");}return e.prototype.get=function(d){return c=this.a,e=m(this.b,d),a(c,function(a){k(e)&&l();var d=new Request((e||"").toString());return a.match(d).then(function(a){return!(!a||b(c,d,a))&&a.json()})});var c,e},e.prototype.set=function(b,c,e){return d=this.a,n=m(this.b,b),h=c,f=e,a(d,function(a){(k(n)||k(h))&&l();var c=new Request((n||"").toString()),b={"Content-Type":"application/json"};h=JSON.stringify(h);f&&(b["x-d"]=Math.round(Date.now()/1E3),f=parseInt(f),(isNaN(f)||
0>f)&&l(),b["x-e"]=f.toString());b=new Response(h,{headers:b});return a.put(c,b)});var d,n,h,f},e.prototype.del=function(a){return g(this.a,m(this.b,a))},e.prototype.prune=function(){return a(d=this.a,function(a){return a.keys().then(function(c){var e=[];return c.forEach(function(b){e.push(a.match(b))}),Promise.all(e).then(function(a){a.forEach(function(a,c){b(d,c,a)})})})});var d},e}(),caches.open("x")["catch"](function(a){"SecurityError"!=a.name&&console&&console.error("Cache API: "+a.message);
g(b.CacheApiDBFallback)}).then(function(){g()})):(console&&console.error("No Cache API"),b.CacheApiDB=b.CacheApiDBFallback)}();
